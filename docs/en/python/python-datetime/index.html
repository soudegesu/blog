<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-dns-prefetch-control content=on><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=dns-prefetch href=//pagead2.googlesyndication.com><link rel=dns-prefetch href=//googleads.g.doubleclick.net><link rel=dns-prefetch href=//googleads4.g.doubleclick.net><link rel=dns-prefetch href=//tpc.googlesyndication.com><link rel=dns-prefetch href=//www.gstatic.com><meta name=generator content="Hugo 0.48"><title>Convert a string representing the date or epoch time to datetime and change timezone in Python - Sou-Nan-De-Gesu</title><meta name=description content="Convert date formatted string or epochtime to datetime, and change timezone in Python.I often convert epochtime and string formatted datetime from middlware and other data sources. This post is a memo for myself."><meta property=og:description content="Convert date formatted string or epochtime to datetime, and change timezone in Python.I often convert epochtime and string formatted datetime from middlware and other data sources. This post is a memo for myself."><meta name=author content=soudegesu><link rel=canonical href=https://www.soudegesu.com/en/python/python-datetime/><link rel=alternate hreflang=en href=https://www.soudegesu.com/en/python/python-datetime/><link rel=alternate hreflang=ja href=https://www.soudegesu.com/python/python-datetime/><link rel=alternate hreflang=x-default href=https://www.soudegesu.com/en/python/python-datetime/><meta name=twitter:site content=@alten_manten><meta name=twitter:title content="Convert a string representing the date or epoch time to datetime and change timezone in Python - Sou-Nan-De-Gesu"><meta name=twitter:description content="Convert date formatted string or epochtime to datetime, and change timezone in Python.I often convert epochtime and string formatted datetime from middlware and other data sources. This post is a memo for myself."><meta name=twitter:url content=https://www.soudegesu.com/en/python/python-datetime/><meta name=twitter:card content=summary_large_image><meta name=twitter:creator content=@alten_manten><meta property=og:locale content=en-US><meta property=og:site_name content="Convert a string representing the date or epoch time to datetime and change timezone in Python - Sou-Nan-De-Gesu"><meta property=og:title content="Convert a string representing the date or epoch time to datetime and change timezone in Python - Sou-Nan-De-Gesu"><meta property=og:url content=https://www.soudegesu.com/en/python/python-datetime/><meta property=og:image content=/images/icons/python_icon.png><meta name=twitter:image content=/images/icons/python_icon.png><meta property=og:type content=article><meta property=article:published_time content="2018-04-22 00:00:00 &#43;0000 UTC"><link rel=prev href=Page%28/past/2018-05-02-colaboratory-is-a-good-tool-for-tensorflow-user.en.md%29><link rel=next href=Page%28/past/2018-02-19-rds-aurora-cluster-partitioning-procedure.en.md%29><script type=application/ld+json>
  {
    "@context": "http://schema.org",
    "@type": "Organization",
    "url": "https://www.soudegesu.com",
    "logo": "https://www.soudegesu.com/images/soudegesu.jpg"
  }
</script><script type=application/ld+json>
  {
    "@context" : "http://schema.org",
    "@type" : "Person",
    "name" : "soudegesu",
    "url" : "https://www.soudegesu.com",
    "sameAs" : null
  }
</script><meta name=google-site-verification content=cTEFKilSiC4rSg768JEVSgidHaZ0Kq9fbgnqqOYW9Uw><meta name=msvalidate.01 content=C58B4D4C2D3C5B99C7CF26F79733F9EB><meta name=yandex-verification content=2f79a5310dc24118><meta property=og:title content="Convert a string representing the date or epoch time to datetime and change timezone in Python"><meta property=og:description content="Convert date formatted string or epochtime to datetime, and change timezone in Python.I often convert epochtime and string formatted datetime from middlware and other data sources. This post is a memo for myself."><meta property=og:type content=article><meta property=og:url content=https://www.soudegesu.com/en/python/python-datetime/><meta property=article:published_time content=2018-04-22T00:00:00&#43;00:00><meta property=article:modified_time content=2018-04-22T00:00:00&#43;00:00><meta property=og:site_name content=Sou-Nan-De-Gesu><meta name=twitter:card content=summary><meta name=twitter:title content="Convert a string representing the date or epoch time to datetime and change timezone in Python"><meta name=twitter:description content="Convert date formatted string or epochtime to datetime, and change timezone in Python.I often convert epochtime and string formatted datetime from middlware and other data sources. This post is a memo for myself."><link rel=stylesheet href=/css/style.css><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-92599175-1','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script async src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><script>(adsbygoogle=window.adsbygoogle||[]).push({google_ad_client:"ca-pub-5005266309965277",enable_page_level_ads:true});</script><script async src=https://cdn.ampproject.org/v0/amp-auto-ads-0.1.js custom-element=amp-auto-ads></script><amp-auto-ads type=adsense data-ad-client=ca-pub-5005266309965277></head><body class=body><div class="container container-outer"><header class=header><div class="container container-inner"><div class=logo role=banner><a class=logo__link href=/en title=Sou-Nan-De-Gesu rel=home><div class=logo__title>Sou-Nan-De-Gesu</div><div class=logo__tagline>Once again, I cut a worthless object</div></a></div></div><nav class=menu><ul class=menu__list><li class="menu__item menu__link">Language</li><li class="menu__item menu__item--active"><a class=menu__link href=#>English</a></li><li class=menu__item><a class=menu__link href=https://www.soudegesu.com/python/python-datetime/>日本語</a></li></ul></nav></header><div class="wrapper flex"><main class="main content"><article class=post><header class=post__header><h1 class=post__title>Convert a string representing the date or epoch time to datetime and change timezone in Python</h1><div class="post__meta meta"><svg class="icon icon-time" width="16" height="14" viewBox="0 0 16 16"><path d="m8-3e-7c-4.4.0-8 3.6-8 8C0 12.4 3.6 16 8 16c4.4.0 8-3.6 8-8.0000003.0-4.4-3.6-8-8-8zM8 14.4c-3.52.0-6.4-2.88-6.4-6.4000003.0-3.52 2.88-6.4 6.4-6.4 3.52.0 6.4 2.88 6.4 6.4C14.4 11.52 11.52 14.4 8 14.4zm.4-10.4000003H7.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"/></svg><time class="post__meta-date meta-date" datetime=2018-04-22T00:00:00>April 22, 2018</time>
<span class="post__meta-categories meta-categories"><svg class="icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta-categories__list><a class=meta-categories__link href=/en/categories/python rel=category>python</a></span></span></div></header><figure class=post__thumbnail><img src=/images/icons/python_icon.png alt="Convert a string representing the date or epoch time to datetime and change timezone in Python"></figure><div class="post__toc toc"><div class=toc__title>Page content</div><div class=toc__menu><nav id=TableOfContents><ul><li><ul><li><a href=#motivation>Motivation</a></li><li><a href=#environment>Environment</a></li><li><a href=#convert-epoch-time-to-datetime>Convert epoch time to datetime</a><ul><li><a href=#covert-epoch-second>Covert epoch second</a></li><li><a href=#covert-epoch-millisecond-expressed-in-decimal>Covert epoch millisecond expressed in decimal</a></li><li><a href=#convert-epoch-millisecond-expressed-in-integer>Convert epoch millisecond expressed in integer</a></li></ul></li><li><a href=#convert-string-to-datetime>Convert string to datetime</a><ul><li><a href=#convert-date-string-with-timezone>Convert date string with timezone</a></li><li><a href=#convert-date-string-without-timezone>Convert date string without timezone</a></li></ul></li><li><a href=#points-to-keep-in-mind-when-dealing-with-date-and-time>Points to keep in mind when dealing with date and time</a><ul><li><a href=#naive-and-aware>naive and aware</a></li><li><a href=#pay-attention-to-processing-with-timezone-on-application-execution-environment>Pay attention to processing with timezone on application execution environment</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></li></ul></nav></div></div><div class="post__content clearfix"><h2 id=motivation>Motivation</h2><p>Because I always google the way to convert a string representing the date to datetime and change timezone on the Internet, this is note to self article.</p><p>There are three types to process date and time in Python. <code>datetime</code>, <code>date</code>, and <code>time</code>.
I mainly use <code>datetime</code> in this article.</p><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-5005266309965277 data-ad-slot=7057233336></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script><h2 id=environment>Environment</h2><ul><li>python 3.6</li><li>pytz</li><li>jupyter notebook</li></ul><h2 id=convert-epoch-time-to-datetime>Convert epoch time to datetime</h2><p>Now convert numeric data types of <code>eopch time</code> to <code>datetime</code>.</p><p>The <code>epoch time</code> is also called as <code>Unix time</code> and this counts starts at the Unix Epoch on January 1st, 1970 at UTC. Therefore, the unix time is merely the number of seconds between a particular date and the Unix Epoch.</p><p>Just one thing to be careful of this conversion is to check whether the numeric types of epoch time is in <strong>second or millisecond</strong>. It is often the case that I judge it by digits or actual calculation by fuction.</p><p>Using the <code>fromtimestamp</code> function in <code>datetime</code> module makes the code simpler as well.</p><h3 id=covert-epoch-second>Covert epoch second</h3><p>Sample code with <code>fromtimestamp</code> function is as bellow.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">1</span><span style=color:#f92672>import</span> datetime
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">2</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">3</span>e <span style=color:#f92672>=</span> <span style=color:#ae81ff>1524349374</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">4</span>dt <span style=color:#f92672>=</span> datetime<span style=color:#f92672>.</span>datetime<span style=color:#f92672>.</span>fromtimestamp(e)
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">5</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">6</span><span style=color:#66d9ef>print</span>(dt)
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">7</span><span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>2018</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span><span style=color:#f92672>-</span><span style=color:#ae81ff>22</span> <span style=color:#ae81ff>07</span>:<span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>54</span></code></pre></div><h3 id=covert-epoch-millisecond-expressed-in-decimal>Covert epoch millisecond expressed in decimal</h3><p>The <code>fromtimestamp</code> function can convert without problems even if a value is milliseconds format below the decimal point.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">1</span><span style=color:#f92672>import</span> datetime
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">2</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">3</span>mills <span style=color:#f92672>=</span> <span style=color:#ae81ff>1524349374.099776</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">4</span>dt2 <span style=color:#f92672>=</span> datetime<span style=color:#f92672>.</span>datetime<span style=color:#f92672>.</span>fromtimestamp(mills)
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">5</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">6</span><span style=color:#66d9ef>print</span>(dt2)
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">7</span><span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>2018</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span><span style=color:#f92672>-</span><span style=color:#ae81ff>22</span> <span style=color:#ae81ff>07</span>:<span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>54.099776</span></code></pre></div><h3 id=convert-epoch-millisecond-expressed-in-integer>Convert epoch millisecond expressed in integer</h3><p>In milliseconds expressed as an integer (epoch millisecond notation), divide a value after checking how many digits represent milliseconds.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">1</span><span style=color:#f92672>import</span> datetime
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">2</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">3</span>mills <span style=color:#f92672>=</span> <span style=color:#ae81ff>1524349374099</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">4</span>dt3 <span style=color:#f92672>=</span> datetime<span style=color:#f92672>.</span>datetime<span style=color:#f92672>.</span>fromtimestamp(mills <span style=color:#f92672>/</span> <span style=color:#ae81ff>1000</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">5</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">6</span><span style=color:#66d9ef>print</span>(dt3)
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">7</span><span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>2018</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span><span style=color:#f92672>-</span><span style=color:#ae81ff>22</span> <span style=color:#ae81ff>07</span>:<span style=color:#ae81ff>22</span>:<span style=color:#ae81ff>54.099000</span></code></pre></div><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-5005266309965277 data-ad-slot=7057233336></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script><h2 id=convert-string-to-datetime>Convert string to datetime</h2><h3 id=convert-date-string-with-timezone>Convert date string with timezone</h3><p>It is easy to convert date string with timezone to datetime by using <code>strptime</code> function. %z means that UTC offset in the form <code>+HHMM</code> or <code>-HHMM</code> and <code>%f</code> means microsecond as a decimal number which zero-padded on the left.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">1</span><span style=color:#f92672>import</span> datetime
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">2</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">3</span>utc_date_str <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;2018-04-01 20:10:56.123+0900&#39;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">4</span>dt <span style=color:#f92672>=</span> datetime<span style=color:#f92672>.</span>datetime<span style=color:#f92672>.</span>strptime(utc_date_str, <span style=color:#e6db74>&#39;%Y-%m-</span><span style=color:#e6db74>%d</span><span style=color:#e6db74> %H:%M:%S.</span><span style=color:#e6db74>%f</span><span style=color:#e6db74>%z&#39;</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">5</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">6</span><span style=color:#66d9ef>print</span>(dt)
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">7</span><span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>2018</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span> <span style=color:#ae81ff>20</span>:<span style=color:#ae81ff>10</span>:<span style=color:#ae81ff>56.123000</span><span style=color:#f92672>+</span><span style=color:#ae81ff>09</span>:<span style=color:#ae81ff>00</span></code></pre></div><h3 id=convert-date-string-without-timezone>Convert date string without timezone</h3><p>Converting a date string without timezone to datetime is troublesome because checking what timezone the string represents is neccesarry.
After checking the specification of data, using string joining is a quick solution.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7c7c79"> 1</span><span style=color:#f92672>import</span> datetime
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79"> 2</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79"> 3</span>utc_date_str <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;2018-04-01 20:10:56&#39;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79"> 4</span><span style=color:#75715e># as JST</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79"> 5</span>dt <span style=color:#f92672>=</span> datetime<span style=color:#f92672>.</span>datetime<span style=color:#f92672>.</span>strptime(utc_date_str <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;+0900&#39;</span>, <span style=color:#e6db74>&#39;%Y-%m-</span><span style=color:#e6db74>%d</span><span style=color:#e6db74> %H:%M:%S%z&#39;</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79"> 6</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79"> 7</span><span style=color:#66d9ef>print</span>(dt)
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79"> 8</span><span style=color:#66d9ef>print</span>(dt<span style=color:#f92672>.</span>tzinfo)
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79"> 9</span><span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>2018</span><span style=color:#f92672>-</span><span style=color:#ae81ff>04</span><span style=color:#f92672>-</span><span style=color:#ae81ff>01</span> <span style=color:#ae81ff>20</span>:<span style=color:#ae81ff>10</span>:<span style=color:#ae81ff>56</span><span style=color:#f92672>+</span><span style=color:#ae81ff>09</span>:<span style=color:#ae81ff>00</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">10</span><span style=color:#f92672>&gt;&gt;</span> UTC<span style=color:#f92672>+</span><span style=color:#ae81ff>09</span>:<span style=color:#ae81ff>00</span></code></pre></div><p>Here&rsquo;s another way to use <code>parse</code> function in <code>dateutil</code> library.
The way to giving <code>tzinfos</code> object to argument, compared to the previous <code>fromtimestamp</code> example, improves readability of the code.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">1</span><span style=color:#f92672>import</span> datetime
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">2</span><span style=color:#f92672>from</span> dateutil.parser <span style=color:#f92672>import</span> parse
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">3</span><span style=color:#f92672>from</span> dateutil.tz <span style=color:#f92672>import</span> gettz
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">4</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">5</span>tzinfos <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;JST&#39;</span> : gettz(<span style=color:#e6db74>&#39;Asia/Tokyo&#39;</span>)}
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">6</span>date_str <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;2018-04-01 20:10:56&#39;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">7</span>str_to_dt <span style=color:#f92672>=</span> parse(date_str <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39; JST&#39;</span>, tzinfos<span style=color:#f92672>=</span>tzinfos)
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">8</span><span style=color:#66d9ef>print</span>(str_to_dt)</code></pre></div><ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-5005266309965277 data-ad-slot=7057233336></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script><h2 id=points-to-keep-in-mind-when-dealing-with-date-and-time>Points to keep in mind when dealing with date and time</h2><h3 id=naive-and-aware>naive and aware</h3><p>In dealing with date and time in Python, keep in mind two kind of data <strong>naive</strong> and <strong>aware</strong>.</p><p>The official Python document says as below,</p><ul><li>aware</li></ul><blockquote><p>An aware object has sufficient knowledge of applicable algorithmic and political time adjustments, such as time zone and daylight saving time information, to locate itself relative to other aware objects. An aware object is used to represent a specific moment in time that is not open to interpretation</p></blockquote><ul><li>naive</li></ul><blockquote><p>A naive object does not contain enough information to unambiguously locate itself relative to other date/time objects. Whether a naive object represents Coordinated Universal Time (UTC), local time, or time in some other timezone is purely up to the program, just like it is up to the program whether a particular number represents metres, miles, or mass. Naive objects are easy to understand and to work with, at the cost of ignoring some aspects of reality.</p></blockquote><p>In short, the <code>aware</code> object should be used in dealing with time data with timezone.</p><p>However, relationship between <strong>types and <code>aware</code>/<code>naive</code> objects</strong> is complicated because
objects created from types are not unique.</p><table><thead><tr><th>types</th><th>object</th></tr></thead><tbody><tr><td>date</td><td>naive</td></tr><tr><td>time</td><td>naive or aware</td></tr><tr><td>datetime</td><td>naive or aware</td></tr></tbody></table><p>Whether the <code>time</code> and<code>datetime</code> types are <code>aware</code> or<code>naive</code> can be checked below.</p><table><thead><tr><th>object</th><th>condition to become aware</th><th>condition to become naive</th></tr></thead><tbody><tr><td>time</td><td><code>t.tzinfo</code> of object <code>t</code> is not None, and <code>t.tzinfo.utcoffset(None)</code> returns not None</td><td>Other than aware</td></tr><tr><td>datetime</td><td><code>t.tzinfo</code> of object <code>t</code> is not None, and <code>t.tzinfo.utcoffset(t)</code> returns not None</td><td><code>d.tzinfo</code> is None. Or <code>d.tzinfo</code> is not None and <code>d.tzinfo.utcoffset(d)</code> returns None</td></tr></tbody></table><h3 id=pay-attention-to-processing-with-timezone-on-application-execution-environment>Pay attention to processing with timezone on application execution environment</h3><p>If executing the timezone conversion code without paying attention to aware and naive,
the response of code will be changed depending on runtime environment.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style="margin-right:.4em;padding:0 .4em;color:#7c7c79"> 1</span><span style=color:#f92672>import</span> datetime
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79"> 2</span><span style=color:#f92672>from</span> pytz <span style=color:#f92672>import</span> timezone
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79"> 3</span><span style=color:#f92672>import</span> pytz
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79"> 4</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79"> 5</span>date_str <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;2018-04-01 20:10:56&#39;</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79"> 6</span><span style=color:#75715e># str_to_dt is `naive`</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79"> 7</span>str_to_dt <span style=color:#f92672>=</span> datetime<span style=color:#f92672>.</span>datetime<span style=color:#f92672>.</span>strptime(date_str, <span style=color:#e6db74>&#39;%Y-%m-</span><span style=color:#e6db74>%d</span><span style=color:#e6db74> %H:%M:%S&#39;</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79"> 8</span><span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;Str to dt&#34;</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79"> 9</span><span style=color:#66d9ef>print</span>(str_to_dt)                      <span style=color:#75715e># 2018-04-01 20:10:56</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">10</span><span style=color:#66d9ef>print</span>(str_to_dt<span style=color:#f92672>.</span>timestamp())          <span style=color:#75715e># 1522581056.0</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">11</span><span style=color:#66d9ef>print</span>(str_to_dt<span style=color:#f92672>.</span>tzname())             <span style=color:#75715e># None</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">12</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">13</span><span style=color:#75715e># calculating with naive object, returns wrong time</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">14</span>utc <span style=color:#f92672>=</span> timezone(<span style=color:#e6db74>&#39;UTC&#39;</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">15</span>utc_dt <span style=color:#f92672>=</span> str_to_dt<span style=color:#f92672>.</span>astimezone(utc)
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">16</span><span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;UTC dt&#34;</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">17</span><span style=color:#66d9ef>print</span>(utc_dt)                         <span style=color:#75715e># 2018-04-01 11:10:56+00:00</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">18</span><span style=color:#66d9ef>print</span>(utc_dt<span style=color:#f92672>.</span>timestamp())             <span style=color:#75715e># 1522581056.0</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">19</span><span style=color:#66d9ef>print</span>(utc_dt<span style=color:#f92672>.</span>tzname())                <span style=color:#75715e># UTC</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">20</span><span style=color:#66d9ef>print</span>(utc_dt<span style=color:#f92672>.</span>tzinfo<span style=color:#f92672>.</span>utcoffset(utc_dt))<span style=color:#75715e># 0:00:00</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">21</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">22</span>jst <span style=color:#f92672>=</span> timezone(<span style=color:#e6db74>&#39;Asia/Tokyo&#39;</span>);
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">23</span>jst_dt <span style=color:#f92672>=</span> str_to_dt<span style=color:#f92672>.</span>astimezone(jst);
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">24</span><span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;JST dt&#34;</span>)
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">25</span><span style=color:#66d9ef>print</span>(jst_dt)                         <span style=color:#75715e># 2018-04-01 20:10:56+09:00</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">26</span><span style=color:#66d9ef>print</span>(jst_dt<span style=color:#f92672>.</span>timestamp())             <span style=color:#75715e># 1522581056.0</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">27</span><span style=color:#66d9ef>print</span>(jst_dt<span style=color:#f92672>.</span>tzname())                <span style=color:#75715e># JST</span>
<span style="margin-right:.4em;padding:0 .4em;color:#7c7c79">28</span><span style=color:#66d9ef>print</span>(jst_dt<span style=color:#f92672>.</span>tzinfo<span style=color:#f92672>.</span>utcoffset(jst_dt))<span style=color:#75715e># 9:00:00</span></code></pre></div><p>In the example code above it shows conversion of string without timezone to datetime as variable named <code>str_to_dt</code>. And when changing timezone with <code>astimezone</code> function, relative calculation is performed from the timezone on the runtime environment to the target timezone.</p><p>For that reason, when using multiple regions of the public cloud,<br>behavior may be different depending on where the program is deployed.</p><h2 id=conclusion>Conclusion</h2><p>It is available to</p><ul><li>Convert epochtime (second and millsecond) to datetime with <code>fromtimestamp</code> function</li><li>Convert string to datetime with <code>strptime</code> function</li><li>Change timezone with <code>dateutil</code> library</li></ul><p>And in dealing with date and time in Python, keep in mind two kind of data <strong>naive</strong> and <strong>aware</strong>.</p><div style=text-align:center><iframe style=width:120px;height:240px marginwidth=0 marginheight=0 scrolling=no frameborder=0 src="//ws-na.amazon-adsystem.com/widgets/q?ServiceVersion=20070822&OneJS=1&Operation=GetAdHtml&MarketPlace=US&source=ss&ref=as_ss_li_til&ad_type=product_link&tracking_id=soudegesu-20&marketplace=amazon&region=US&placement=1449355730&asins=1449355730&linkId=2bcac713b26ea9254a799c102127aa5b&show_border=true&link_opens_in_new_window=true"></iframe>
<iframe style=width:120px;height:240px marginwidth=0 marginheight=0 scrolling=no frameborder=0 src="//ws-na.amazon-adsystem.com/widgets/q?ServiceVersion=20070822&OneJS=1&Operation=GetAdHtml&MarketPlace=US&source=ss&ref=as_ss_li_til&ad_type=product_link&tracking_id=soudegesu-20&marketplace=amazon&region=US&placement=1491933178&asins=1491933178&linkId=af0703a1479cb865d795cf0ffe65b565&show_border=true&link_opens_in_new_window=true"></iframe>
<iframe style=width:120px;height:240px marginwidth=0 marginheight=0 scrolling=no frameborder=0 src="//ws-na.amazon-adsystem.com/widgets/q?ServiceVersion=20070822&OneJS=1&Operation=GetAdHtml&MarketPlace=US&source=ss&ref=as_ss_li_til&ad_type=product_link&tracking_id=soudegesu-20&marketplace=amazon&region=US&placement=1593276036&asins=1593276036&linkId=777aed95358ef80635f1e6f313f0fe1f&show_border=true&link_opens_in_new_window=true"></iframe></div></div><div class="post__tags tags clearfix"><svg class="icon icon-tag" width="16" height="16" viewBox="0 0 16 16"><path d="M16 9.5c0 .373-.24.74-.5 1l-5 5c-.275.26-.634.5-1 .5-.373.0-.74-.24-1-.5L1 8a2.853 2.853.0 0 1-.7-1C.113 6.55.0 5.973.0 5.6V1.4C0 1.034.134.669.401.401.67.134 1.034.0 1.4.0h4.2c.373.0.95.113 1.4.3.45.187.732.432 1 .7l7.5 7.502c.26.274.5.632.5.998zM3.5 5a1.5 1.5.0 1 0 0-3 1.5 1.5.0 0 0 0 3z"/></svg><ul class=tags__list><li class=tags__item><a class="tags__link btn" href=/en/tags/python/ rel=tag>python</a></li></ul></div></article><script async src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-5005266309965277 data-ad-slot=8973386323 data-ad-format=rectangle data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script><nav class="post-nav flex"><div class="post-nav__item post-nav__item--prev"><a class=post-nav__link href=/en/aws/rds-aurora-cluster-partitioning-procedure/ rel=prev><span class=post-nav__caption>«&thinsp;Previous</span><p class=post-nav__post-title>Add partitions periodically in AWS RDS Aurora Cluster (MySQL compatible) with the SQL Procedures</p></a></div><div class="post-nav__item post-nav__item--next"><a class=post-nav__link href=/en/python/colaboratory-is-a-good-tool-for-tensorflow-user/ rel=next><span class=post-nav__caption>Next&thinsp;»</span><p class=post-nav__post-title>Google Colaboratory is the best tool for machine learning engineer</p></a></div></nav><h3>Related Posts</h3><div class=list__item><figure class=list__thumbnail><a href=https://www.soudegesu.com/en/python/pyenv/anaconda/><img src=/images/icons/python_icon.png alt="Setting to avoid python and anaconda conflict using pyenv and pyenv-virtualenv"></a></figure><div class="list__content clearfix"><header class=list__header><h4 class="list__title post__title"><a href=/en/python/pyenv/anaconda/ rel=bookmark>Setting to avoid python and anaconda conflict using pyenv and pyenv-virtualenv</a></h4><div class="list__meta meta"><svg class="icon icon-time" width="16" height="14" viewBox="0 0 16 16"><path d="m8-3e-7c-4.4.0-8 3.6-8 8C0 12.4 3.6 16 8 16c4.4.0 8-3.6 8-8.0000003.0-4.4-3.6-8-8-8zM8 14.4c-3.52.0-6.4-2.88-6.4-6.4000003.0-3.52 2.88-6.4 6.4-6.4 3.52.0 6.4 2.88 6.4 6.4C14.4 11.52 11.52 14.4 8 14.4zm.4-10.4000003H7.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"/></svg><time class="post__meta-date meta-date" datetime=2017-02-28T00:00:00>February 28, 2017</time>
<span class="post__meta-categories meta-categories"><svg class="icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta-categories__list><a class=meta-categories__link href=/en/categories/pyenv rel=category>pyenv</a>, <a class=meta-categories__link href=/en/categories/anaconda rel=category>anaconda</a></span></span></div></header></div></div><div class="authorbox clearfix"><figure class=authorbox__avatar><img alt="soudegesu avatar" src=/images/soudegesu.jpg class=avatar height=90 width=90></figure><div class=authorbox__header><span class=authorbox__name>About soudegesu</span></div><div class=authorbox__description>Software Engineer</div></div><section class=comments><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"soudegesu"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></section></main><aside class=sidebar><div class="widget-search widget"><form class=widget-search__form role=search action=https://google.com/search><label><input class=widget-search__field type=search placeholder=SEARCH... name=q></label>
<input class=widget-search__submit type=submit value=Search>
<input type=hidden name=sitesearch value=https://www.soudegesu.com></form></div><div class="widget-recent widget"><h4 class=widget__title>Recent Posts</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=/en/post/python/http-request-with-urllib/>HTTP requests in Python3 with urllib.request module</a></li><li class=widget__item><a class=widget__link href=/en/post/python/difference-between-pypdf2-and-pypdf3/>Use PyPDF2 - which PyPDF 2 or PyPDF 3 should be used?</a></li><li class=widget__item><a class=widget__link href=/en/post/python/extract-text-from-pdf-with-pypdf2/>Use PyPDF2 - extract text data from PDF file</a></li><li class=widget__item><a class=widget__link href=/en/post/python/open-pdf-with-pypdf2/>Use PyPDF2 - open PDF file or encrypted PDF file</a></li><li class=widget__item><a class=widget__link href=/en/post/python/recommended-ide/>Recommended IDEs or code editors for Python beginner</a></li></ul></div><script async src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-5005266309965277 data-ad-slot=1184942948 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><div class="widget-categories widget"><h4 class=widget__title>Categories</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=/en/categories/anaconda>Anaconda</a></li><li class=widget__item><a class=widget__link href=/en/categories/aws>Aws</a></li><li class=widget__item><a class=widget__link href=/en/categories/docker>Docker</a></li><li class=widget__item><a class=widget__link href=/en/categories/docker-compose>Docker compose</a></li><li class=widget__item><a class=widget__link href=/en/categories/linux>Linux</a></li><li class=widget__item><a class=widget__link href=/en/categories/mysql>Mysql</a></li><li class=widget__item><a class=widget__link href=/en/categories/pyenv>Pyenv</a></li><li class=widget__item><a class=widget__link href=/en/categories/python>Python</a></li></ul></div></div><div class="widget-social widget"><h4 class="widget-social__title widget__title">Social</h4><div class="widget-social__content widget__content"><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=Twitter rel="noopener noreferrer" href=https://twitter.com/alten_manten target=_blank><svg class="widget-social__link-icon icon-twitter" viewBox="0 0 384 312" width="24" height="24" fill="#fff"><path d="m384 36.9c-14.1 6.3-29.3 10.5-45.2 12.4 16.3-9.7 28.8-25.2 34.6-43.6-15.2 9-32.1 15.6-50 19.1-14.4-15.2-34.9-24.8-57.5-24.8-43.5.0-78.8 35.3-78.8 78.8.0 6.2.7 12.2 2 17.9-65.5-3.3-123.5-34.6-162.4-82.3-6.7 11.6-10.6 25.2-10.6 39.6.0 27.3 13.9 51.4 35 65.6-12.9-.4-25.1-4-35.7-9.9v1c0 38.2 27.2 70 63.2 77.2-6.6 1.8-13.6 2.8-20.8 2.8-5.1.0-10-.5-14.8-1.4 10 31.3 39.1 54.1 73.6 54.7-27 21.1-60.9 33.7-97.8 33.7-6.4.0-12.6-.4-18.8-1.1 34.9 22.4 76.3 35.4 120.8 35.4 144.9.0 224.1-120 224.1-224.1.0-3.4-.1-6.8-.2-10.2 15.4-11.1 28.7-25 39.3-40.8z"/></svg><span>Twitter</span></a></div><div class="widget-social__item widget__item"><a class="widget-social__link widget__link btn" title=GitHub rel="noopener noreferrer" href=https://github.com/soudegesu target=_blank><svg class="widget-social__link-icon icon-github" viewBox="0 0 384 374" width="24" height="24" fill="#fff"><path d="m192 0C85.9.0.0 85.8.0 191.7c0 84.7 55 156.6 131.3 181.9 9.6 1.8 13.1-4.2 13.1-9.2.0-4.6-.2-16.6-.3-32.6-53.4 11.6-64.7-25.7-64.7-25.7-8.7-22.1-21.3-28-21.3-28-17.4-11.9 1.3-11.6 1.3-11.6 19.3 1.4 29.4 19.8 29.4 19.8 17.1 29.3 44.9 20.8 55.9 15.9 1.7-12.4 6.7-20.8 12.2-25.6-42.6-4.8-87.5-21.3-87.5-94.8.0-20.9 7.5-38 19.8-51.4-2-4.9-8.6-24.3 1.9-50.7.0.0 16.1-5.2 52.8 19.7 15.3-4.2 31.7-6.4 48.1-6.5 16.3.1 32.7 2.2 48.1 6.5 36.7-24.8 52.8-19.7 52.8-19.7 10.5 26.4 3.9 45.9 1.9 50.7 12.3 13.4 19.7 30.5 19.7 51.4.0 73.7-44.9 89.9-87.7 94.6 6.9 5.9 13 17.6 13 35.5.0 25.6-.2 46.3-.2 52.6.0 5.1 3.5 11.1 13.2 9.2 76.2-25.5 131.2-97.3 131.2-182 0-105.9-86-191.7-192-191.7z"/></svg><span>GitHub</span></a></div></div><script async src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-5005266309965277 data-ad-slot=1661016284 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div><div class="widget-taglist widget"><h4 class=widget__title>Tags</h4><div class=widget__content><a class="widget-taglist__link widget__link btn" href=/en/tags/acm title=Acm>Acm</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/amazonlinux title=Amazonlinux>Amazonlinux</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/anaconda title=Anaconda>Anaconda</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/ansible title=Ansible>Ansible</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/aurora title=Aurora>Aurora</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/aws title=Aws>Aws</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/colaboratory title=Colaboratory>Colaboratory</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/docker title=Docker>Docker</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/ec2 title=Ec2>Ec2</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/excel title=Excel>Excel</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/machine-learning title="Machine learning">Machine learning</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/mysql title=Mysql>Mysql</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/openpyxl title=Openpyxl>Openpyxl</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/packer title=Packer>Packer</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/pandas title=Pandas>Pandas</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/pdf title=Pdf>Pdf</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/pyenv title=Pyenv>Pyenv</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/pyenv-virtualenv title="Pyenv virtualenv">Pyenv virtualenv</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/pypdf2 title=Pypdf2>Pypdf2</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/python title=Python>Python</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/rds title=Rds>Rds</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/route53 title=Route53>Route53</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/sql title=Sql>Sql</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/ssl title=Ssl>Ssl</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/systemd title=Systemd>Systemd</a>
<a class="widget-taglist__link widget__link btn" href=/en/tags/tensorflow title=Tensorflow>Tensorflow</a></div><script async src=//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js></script><ins class=adsbygoogle style=display:block data-ad-client=ca-pub-5005266309965277 data-ad-slot=2162982695 data-ad-format=auto data-full-width-responsive=true></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({});</script></div></aside></div><footer class=footer><div class="container container-inner"><div class=footer__copyright>&copy; 2019 Sou-Nan-De-Gesu. <span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script>var navigation=responsiveNav(".menu",{navClass:"menu--collapse",});</script><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><script src=/js/scripts.js></script><link rel="shortcut icon" href=/favicon.ico></body></html>